<!DOCTYPE html>
<html>
<head>
  <!-- Standard Meta -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <!-- Site Properities -->
  <title>Homepage Example - Semantic</title>

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Open+Sans:300italic,400,300,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" type="text/css" href="{{ theme_static('css/semantic.css') }}">

  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.js"></script>
  <script src="{{ theme_static('javascript/semantic.js') }}"></script>
</head>
<body>

<h1 class="ui header"><span id="title_span">{{ topic.title }}</span></h1>


<span class="rate"></span>
<button id="delete">删除</button>
<div id="title_edit" style="display: none;">
<input id="title_input" style="outline: 0; font-family: 'Microsoft YaHei', sans-serif; color: #1a1a1a; font-size: 27px; vertical-align: middle; width: 100%; " value="{{ topic.title }}" /><br />
<button id="ok">确定</button>
<button id="cancel">取消</button>
    </div>


                    
                    <div class="gallery">
                        {% for image in images %}
                        <a class="ui image" href="{{ url_for('frontend.show_image', oid=image._id) }}" class="gal">
                            <img src="{{ url_for('frontend.show_image', oid=image._id) }}" />
                        </a>
                        {% endfor %}
                    </div>

<script src="{{ theme_static('js/jquery.raty.js') }}"></script>
<script>
$SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
$().ready(function(){
    $("#title_span").dblclick(function(){
        $("#title_edit").slideDown();
        
    });
    $("#cancel").click(function(){
        $("#title_edit").slideUp();
    });
    $("#ok").click(function(){
        $.post($SCRIPT_ROOT + "{{ url_for('.edit_topic', oid=topic._id) }}", {
            title: $('#title_input').val()
        }, function(data) {
            if (data.success == true) {
                $("#title_span").text(data.title);
                $("#title_edit").slideUp();
            }
        });
        return false;
    });

    $("#delete").click(function(){
        $.post($SCRIPT_ROOT + "{{ url_for('.delete_topic', oid=topic._id) }}", {
            title: $('#title_input').val()
        }, function(data) {
            history.go(-1);
        });
        return false;
    });
});
$('.rate').raty({
    score: {{ topic.rate if topic.rate else 0 }},
    path: "{{ theme_static('images/raty') }}",
    iconRange: [
        {range: 1, on: 'star-on-big.png', off: 'star-off-big.png'},
        {range: 5, on: 'star-on-big.png', off: 'star-off-big.png'},
    ],
    size: 24,
    click: function(score, evt) {
        $.post($SCRIPT_ROOT + "{{ url_for('.edit_topic', oid=topic._id) }}", {
            rate: score,
        });
        return false;
    }
});
</script>
</body>